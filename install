#!/usr/bin/env zsh

setopt extendedglob

for f ($0:A:h/^install) rm -rf ~/.$f:t && ln -sfv $f ~/.$f:t
git -C $0:A:h submodule update -j 20 --init --depth=1

for k in user.name user.email; do
  if ! git config -f ~/.gitidentity $k > /dev/null; then
    read "v?${(%):-%4FEnter default $k for git: %f}"
    if [[ -n $v ]] git config -f ~/.gitidentity $k $v
  fi
done

if [[ $OSTYPE == darwin* ]]; then
  tic -xo ~/.terminfo =(echo "nsterm,\n use=xterm-256color,\n\ntmux-256color,
      ritm=\\E[23m,sitm=\\E[3m,rmso=\\E[27m,smso=\\E[7m,use=screen-256color,")
fi
